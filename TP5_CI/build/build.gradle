task purge(type: Delete){ 
    //println 'Cleaning up old files'
    delete 'build/app_python.zip'
}

task dependances(type: Exec, dependsOn: purge){
    executable 'sh'
    args '-c', 'pip3 install -r requirements.txt'
    standardOutput = new ByteArrayOutputStream()
    ext.output = { return standardOutput.toString() }
}

def tarfile ="project-" + version
task packageDistribution(type: Zip, dependsOn: dependances){
    from ('.') into ('.')
    archiveFileName = tarfile + ".zip"
    destinationDirectory = file("build")
}

